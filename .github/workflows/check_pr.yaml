name: Flutter CI

on:
  push:
    branches: [master]
  pull_request:

jobs:
  flutter_tests:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        # ã“ã“ã«ä¸¦åˆ—ã§å®Ÿè¡Œã—ãŸã„ãƒ†ã‚¹ãƒˆã®ç¨®é¡ã‚’å®šç¾©
        test_type: [unit-test, vrt] 
    steps:
      - uses: actions/checkout@v4

      # â–¼â–¼â–¼ Flutterã®ç’°å¢ƒæ§‹ç¯‰ï¼ˆã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯å…±é€šï¼‰ â–¼â–¼â–¼
      - uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.27.1' # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«åˆã‚ã›ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®š
      
      - name: ğŸš€ Install dependencies
        run: flutter pub get

      - name: ğŸ“ Create .env file
        run: touch .env

      # â–¼â–¼â–¼ matrix ã®å€¤ã«å¿œã˜ã¦ã€å®Ÿè¡Œã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ â–¼â–¼â–¼
      - name: Run Unit Tests
        if: matrix.test_type == 'unit-test'
        run: flutter test --exclude-tags golden

      - name: Run VRT
        if: matrix.test_type == 'vrt'
        run: flutter test --update-goldens --tags golden